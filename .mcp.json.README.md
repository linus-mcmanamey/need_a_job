# MCP Configuration Setup

## Overview

The `.mcp.json` file contains Model Context Protocol (MCP) server configurations, including API keys, authentication tokens, and cookies. This file **must not be committed to git** as it contains sensitive credentials.

**NEW:** We now use environment variables from `.env` to generate `.mcp.json` automatically! This is more secure and follows 12-factor app best practices.

## Setup Instructions

### Recommended Approach: Environment Variables (Secure)

1. **Set up your `.env` file:**
   ```bash
   cp .env.example .env
   ```

2. **Add your MCP credentials to `.env`:**
   ```bash
   # Edit .env and set these values:
   LINKEDIN_COOKIE=your-linkedin-li_at-cookie-here
   GITHUB_TOKEN=ghp_your-github-token-here
   ```

3. **Run the setup script to generate `.mcp.json`:**
   ```bash
   python scripts/setup_mcp_config.py
   ```

   This script:
   - Reads credentials from `.env`
   - Substitutes them into `.mcp.json.template`
   - Generates `.mcp.json` with proper permissions (600)
   - Never commits secrets to git

4. **Verify `.mcp.json` was created:**
   ```bash
   ls -la .mcp.json
   # Should show: -rw------- (owner read/write only)
   ```

### Alternative Approach: Manual Configuration (Not Recommended)

1. **Copy the example file:**
   ```bash
   cp .mcp.json.example .mcp.json
   ```

2. **Manually edit credentials** (less secure, not recommended)

## Getting Credentials

### LinkedIn Cookie (Required)
1. Log in to LinkedIn in your browser
2. Open DevTools (F12)
3. Go to Application/Storage → Cookies → https://www.linkedin.com
4. Copy the value of the `li_at` cookie
5. Add to `.env`: `LINKEDIN_COOKIE=<your-cookie-value>`

### GitHub Token (Optional)
1. Go to GitHub Settings → Developer settings → Personal access tokens
2. Generate new token with scopes: `repo`, `read:org`
3. Copy the generated token
4. Add to `.env`: `GITHUB_TOKEN=<your-token>`

## Docker Usage

For Docker deployments, **do not include `.mcp.json` in the image**. Instead, use one of these approaches:

### Option 1: Environment Variables (Recommended)
Pass credentials as environment variables and generate `.mcp.json` at container startup:

```bash
docker run \
  -e LINKEDIN_COOKIE="your_cookie" \
  -e GITHUB_TOKEN="your_token" \
  --entrypoint /bin/sh \
  your-image -c "python scripts/setup_mcp_config.py && uvicorn app.api.main:app"
```

Or use docker-compose with `.env` file:
```yaml
version: '3.8'
services:
  app:
    image: your-image
    env_file: .env  # Loads LINKEDIN_COOKIE and GITHUB_TOKEN
    command: sh -c "python scripts/setup_mcp_config.py && uvicorn app.api.main:app"
```

### Option 2: Volume Mount (Simple)
Pre-generate `.mcp.json` locally and mount it:
```bash
# First, generate .mcp.json locally
python scripts/setup_mcp_config.py

# Then mount it into container
docker run -v $(pwd)/.mcp.json:/app/.mcp.json your-image
```

### Option 3: Docker Secrets (Production)
For production with orchestrators (Swarm/Kubernetes):
```bash
# Swarm
docker secret create linkedin_cookie -
docker secret create github_token -
docker service create \
  --secret linkedin_cookie \
  --secret github_token \
  your-image

# Kubernetes
kubectl create secret generic mcp-credentials \
  --from-literal=linkedin-cookie="your_cookie" \
  --from-literal=github-token="your_token"
```

## Security Notes

⚠️ **IMPORTANT:**
- `.mcp.json` is in `.gitignore` - do not force-add it
- Never commit credentials to version control
- Rotate credentials immediately if accidentally exposed
- Use different credentials for development/production
- Consider using a secrets manager (AWS Secrets Manager, HashiCorp Vault, etc.)

## Troubleshooting

**MCP servers not working?**
1. Verify `.mcp.json` exists in the project root
2. Check credentials are valid and not expired
3. Ensure file has correct JSON syntax
4. Check MCP server logs for connection errors
